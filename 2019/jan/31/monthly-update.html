<!DOCTYPE html>
<html lang="en">
  
<!-- Mirrored from blog.nut/2019/jan/31/monthly-update by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Oct 2020 14:56:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <script>var _gaq = _gaq || []; _gaq.push(['_setDomainName', location.hostname]);</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1">
    <title>
Monthly Update: January 2019 -       Félix “passcod” Saparelli - Blog
    </title>
    <link rel="alternate" href="../../../feed">
    <link rel="stylesheet" href="../../../assets/1.3.3/style.css">
  </head>

  <body>
    <div class="raised">
      <header class="root">
        <h1><a href="../../../index.html">Félix Saparelli</a></h1>
        <p class="sidelong"><a rel="me" href="https://passcod.name/">(about me)</a></p>
        <p class="subtitle">a.k.a. passcod<a href="https://blog.passcod.name/trademark">™</a></p>
      </header>
      <main>
        <article class="h-entry e-content">
  <header>
    <h1 class="p-name">Monthly Update: January 2019</h1>

  
    <p>Posted on <a href="monthly-update.html" class="u-url"><date datetime="2019-01-31T07:00:00.000Z" title="2019-01-31T07:00:00.000Z" class="dt-published">Jan 31 ‘19</date></a></p>
  

  
    <p>This
      is a 
      <a href="../../../tag/monthly-update.html" rel="main tag" class="p-category">monthly-update</a>
      
    </p>
  

  
  </header>

  <h2>Monthly updates are now actually monthly</h2>
<p>The 10th-day thing got old. It was an artifact of when I actually started this
monthly thing, but the confusion of writing about half of the past month and
half of the current was really odd.</p>
<p>So now updates are published on the last day of the month, at 20 o’clock local.</p>
<h2>Monthly updates may not actually be monthly anymore</h2>
<p>Two years ago when I did those every month, I did make an effort to get
something done every month. Last year it was a bit lackluster. This year, I’m
basically throwing in the towel. Updates will happen, but they might not happen
every month. Or maybe they will. Habits are hard to break, and I’m not trying to
break this one, so we’ll see how it goes.</p>
<h2>Armstrong</h2>
<p>I think I’m ready to start talking about this.</p>
<p>Armstrong is a project that has been brewing for the past year or so.</p>
<p>The concept comes, as often with new projects, out of frustration and want.
Armstrong is a job system. Or a job framework. Maybe a job queue. Task queue.
Orchestrator. Scheduler. It is an evolution of <a href="http://gearman.org/">Gearman</a>, adding features rather
than removing them (there are many extra-minimal job queues out there), and
keeping to the patterns that make Gearman strong in my opinion.</p>
<p>There is a laundry list of features, but one I want to describe here is the
priority system.</p>
<p>Priorities in Gearman work on the basis of three FIFO queues per worker, where
“worker” means a particular type of task that’s handled by a pool of worker
clients. Those three queues are <em>high</em>, <em>normal</em>, <em>low</em>. Jobs, by default, go
into the <em>normal</em> queue, but you can decide which queue they go to explicitly.
The <em>normal</em> queue is only processed when there are no <em>high</em> jobs, and so on.
Within a queue, jobs are processed in order.</p>
<p>This leads to patterns and rules being established in userspace to ensure good
system behaviour. For example, pushing to the <em>high</em> queue is strictly
controlled, so that it remains empty most of the time, except for when something
urgent comes through. Otherwise it’s all too easy to need an urgent compute and
having its jobs just queue up politely <em>riiiight</em> at the back.</p>
<p>Armstrong’s priorities work on the basis of a single giant dynamic queue, not
only for each worker, but for all workers all at once. Priority, at the
interface, is expressed in <strong>time expectation</strong>.</p>
<p>One can say:</p>
<ul>
<li>I don’t care when this job runs, I just want it done sometime.</li>
<li>I need this job to run within the hour.</li>
<li>These tasks all need to finish within 500 milliseconds.</li>
</ul>
<p>Armstrong then figures out how to achieve that.</p>
<p>The most obvious option is to re-order the queue based on this timing metric,
but that’s not all it can do.</p>
<p>Firstly, as a bit of background, Armstrong keeps records of what jobs ran when,
where, for how long, etc. This is for audit, debugging, monitoring. It’s also
for making priority and scheduling decisions.</p>
<p>Given a job description, the system can query this record and derive the
expected duration of the job, for example by averaging the last few runs.
Without you having to say so, it knows how long jobs take, and can re-order the
queue based on that. Even better, it knows how long jobs take on different
hosts, so it can schedule more efficiently, again without prompting.</p>
<p>Secondly, on an opt-in basis, Armstrong workers may be interruptible. This may
be achieved through custom logic, or it can be achieved using kernel interfaces,
like <code>SIGSTOP</code>, <code>SIGCONT</code>, or <code>SuspendProcess()</code>.</p>
<p>If an urgent job comes through and whatever is currently running will not finish
in time, Armstrong interrupts the jobs, schedules and runs the urgent jobs, then
un-pauses the jobs.</p>
<p>This combination of granular priority, record querying, and control superpowers
makes efficient compute use easy and eliminates hours of setup and discussions.</p>
<p>And through this one feature, you can already see other aspects of the system.
More later!</p>
<p>Armstrong is still in development, and no parts of it are yet available.</p>
<h2>Fiction</h2>
<ul>
<li><strong><a href="https://archiveofourown.org/works/17122601">Reports of Witches Falling</a></strong>. {2k words}</li>
</ul>
<h2>Fanfiction</h2>
<ul>
<li>{Marvel} <a href="https://archiveofourown.org/works/1877010">The Plural of Mongoose</a>. {1k words}</li>
<li>{HP} <a href="https://archiveofourown.org/works/3108170">A Lack of Static Identity</a>. {3k words}</li>
<li>{HP} <a href="https://archiveofourown.org/works/17268434">In Which Sirius Black Fails to Argue with a Hat</a>. {14k words atow}</li>
<li>{HP} <strong><a href="https://archiveofourown.org/works/17267996">Unassuming Hufflepuff</a></strong>. {12k words atow}</li>
<li>{SW} <a href="https://archiveofourown.org/series/254248">‘Blackest Circle’ series</a>. {8k words atow}</li>
<li>{SW} <a href="https://archiveofourown.org/series/204314">‘Letters…’ series</a>. {44k words atow}</li>
<li>{SW} <a href="https://archiveofourown.org/series/25054">‘Field, Garden, Oasis’ series</a>. {8k words}</li>
<li>{Highlander} <a href="https://archiveofourown.org/works/508546">You Can Find Me Here</a>. {3k words}</li>
<li>{SW} <a href="https://archiveofourown.org/works/16807552">Til The Casket Drops</a>. {36k words atow}</li>
<li>{SW} <a href="https://archiveofourown.org/works/12271554">Terriers of Conflict Resolution</a>. {5k words}</li>
<li>{SW} <a href="https://archiveofourown.org/works/11778969">Second Chances</a>. {6k words}</li>
<li>{SW} <strong><a href="https://archiveofourown.org/works/17305367">Concordance</a></strong>. {16k words atow}</li>
<li>{40k} <a href="https://archiveofourown.org/works/17408942">Giltran</a>. {2k words}</li>
<li>{SW} <a href="https://archiveofourown.org/works/496954">Speaker of Valaeanath</a>. {19k words}</li>
<li>{SW} <a href="https://archiveofourown.org/works/12424332">Tell Me No Tales</a>. {91k words atow}</li>
<li>{HP} <strong><a href="https://archiveofourown.org/works/15537897">Novocaine</a></strong>. {176k words atow}</li>
</ul>
<h2>Non-fiction</h2>
<ul>
<li>{CS} <a href="https://mitpress.mit.edu/books/little-typer">The Little Typer</a>. (started, not yet finished)</li>
</ul>


  <footer>
  
    <p>Travel back to the <a rel="prev" href="../../../2018/dec/31/yearly-summary.html" title="Last year, I gave myself three objectives: Read 300 books. That didn’t pan out! I read maybe 10. But I also weaned myself off fanfiction, to the point where I read mostly updates now, and not very much new…">previous</a> article</p>
  

  
    <p>Skip forward to the <a rel="next" href="../../feb/28/monthly-update.html" title="Notify There’s a bunch of work happening on Notify at the moment. I’ve basically taken it out of being “frozen” and back into maintainership. I do not want to spend any significant amount of time on it, but I welcome anyone else…">next</a> one</p>
  

    <p>Praise, thoughts, criticism? <a href="https://twitter.com/passcod">@passcod</a> or <a href="mailto:felix@passcod.name">felix@passcod.name</a></p>

  
  </footer>
</article>

      </main>
    </div>
    <footer class="root">
      <p>
        <a rel="alternate" href="../../../feed">Feed</a>.
        © 2008–2020.
        Content licensed under <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.
      </p>
    </footer>

    <button class="flip" title="Turn the lights off.">day</button>
    <script async src="../../../assets/1.3.3/circadian.js"></script>
    <script async src="../../../assets/1.3.3/prism.js"></script>

    <link rel="stylesheet" href="../../../assets/1.3.3/fonts.css">
    <link rel="stylesheet" href="../../../assets/1.3.3/prism.css">
  </body>

<!-- Mirrored from blog.nut/2019/jan/31/monthly-update by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 15 Oct 2020 14:56:14 GMT -->
</html>
